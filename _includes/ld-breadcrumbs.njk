{# _includes/ld-breadcrumbs.njk #}
{# Si no se definen migas manuales, usamos: Inicio → Página actual #}
{% if page.url and page.url != "/" %}

  {# Permite sobreescribir con front matter:
     breadcrumbs: [{ name: "Inicio", url: "/" }, { name: "Servicios", url: "/servicios/" }, ...] #}
  {% set crumbs = breadcrumbs or [
    { "name": "Inicio", "url": "/" },
    { "name": page.title or "Página", "url": page.url }
  ] %}

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {% for c in crumbs %}
        {% set itemUrl = c.url %}
        {% if itemUrl and itemUrl[0] == '/' %}
          {% set itemUrl = site.url + itemUrl %}
        {% endif %}
        {
          "@type": "ListItem",
          "position": {{ loop.index }},
          "name": {{ c.name | dump }},
          "item": {{ itemUrl | dump }}
        }{{ not loop.last ? ',' : '' }}
      {% endfor %}
    ]
  }
  </script>

{% endif %}
