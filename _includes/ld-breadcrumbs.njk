{# _includes/ld-breadcrumbs.njk #}
{# Trail: usa front matter "breadcrumbs" si existe; si no, Inicio + página actual #}
{% set trail = breadcrumbs
  or [
    { "name": "Inicio", "url": "/" },
    { "name": (title or (page.fileSlug | replace("-", " "))), "url": page.url }
  ]
%}

{# Solo imprimimos si hay ≥2 elementos (evita Home sola) #}
{% if (trail | length) > 1 %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "@id": "{{ site.url }}{{ page.url }}#breadcrumb",
  "itemListElement": [
{% for item in trail %}
{% set u = item.url %}
{% if u and (u.indexOf('http') != 0) %}
  {% set u = site.url + u %}
{% endif %}
    {
      "@type": "ListItem",
      "position": {{ loop.index }},
      "name": {{ item.name | dump | safe }},
      "item": {{ u | dump }}
    }{% if not loop.last %},{% endif %}
{% endfor %}
  ]
}
</script>
{% endif %}
